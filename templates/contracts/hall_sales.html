{% extends 'layout/base.html' %}
{% load i18n %}
{% load static %}
{% load contract_tags %}
{% block title %} {% trans "Hall sales" %} {% endblock title %}

{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

	<!-- Main content -->
	<div class="content-wrapper">

		<!-- Page header -->
		<div class="page-header">
			<div class="page-header-content">
				<div class="page-title">
					<h4>
						<i class="icon-arrow-left52 position-left"></i>
						<span class="text-semibold">{% trans "Contract" %}</span> - {% trans "Hall sales" %}
					</h4>
				</div>
			</div>

			<div class="breadcrumb-line breadcrumb-line-component">
				<ul class="breadcrumb">
					<li><a><i class="icon-cart2 position-left"></i>{% trans "Contract" %}</a></li>
					<li class="active">{% trans "Hall sales" %}</li>
				</ul>
			</div>
		</div>
		<!-- /page header -->

		<!-- Content area -->
		<div class="content">

			<!-- Main charts -->
			<div class="row">
				<div class="col-lg-12">

					<!-- Traffic sources -->
					<form action="" method="POST" name="hall_sales">

						{% csrf_token %}

						<div class="panel panel-flat px-3">
							<div class="panel-title-wrapper container-fluid">
								<div class="row d-flex flex-wrap pt-10-px">
									<div class="col-3 text-left d-flex align-items-center">
										<label class="control-label mb-0">No.</label>
										<div class="col-6">
											<input type="text" class="form-control border-none" name="contract_id" value="1223" readonly>
										</div>
									</div>
									<div class="col-6 d-flex align-items-center justify-content-center">
										<h2 class="panel-title text-center">{% trans "Sales contract" %}</h2>
									</div>
									
									<div class="col-3 col-sm-12">
										<div class="d-flex align-items-center justify-content-end">
											<div class="input-group">
												<span class="input-group-addon"><i class="icon-calendar22"></i></span>
												<input type="text" name="created_at" class="form-control daterange-single">
											</div>
										</div>
									</div>
								</div>
							</div>
	
							<div class="container-fluid">
								<div class="row flex-wrap d-flex">
									<div class="col-lg-6 col-xs-12">
										<h3>{% trans "Buyer" %}({% trans "A" %})</h3>
										
										<div class="offset-1">
											<div class="col-lg-12">
												<div class="form-group d-flex row">
													<label class="control-label col-lg-3 mt-auto">{% trans "Keyword search" %}</label>
													<div class="col-lg-9">
														<select class="select-customer" name="customer_id">
															<option value="" selected>{% trans "Search by customer, frigana, tel or fax" %}</option>
														</select>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="col-lg-6">
										<h3>{% trans "Seller" %}({% trans "B" %})</h3>
										<div class="offset-1">
											<div class="form-group">
												<span class="mr-4">
													{% trans "Company name" %}
												</span>
												<span>{{ seller_company }}</span>
											</div>
											<div class="form-group">
												<span class="mr-4">
													{% trans "Address" %}
												</span>
												<span>{{ seller_address }}</span>
											</div>
											<div class="form-group d-flex">
												<div class="w-50">
													<span class="mr-4">
														{% trans "TEL" %}
													</span>
													<span>{{ seller_tel }}</span>
												</div>
												<div class="w-50">
													<span class="mr-4">
														{% trans "FAX" %}
													</span>
													<span>{{ seller_fax }}</span>
												</div>
											</div>
										</div>
									</div>
								</div>
								
								<div class="row d-flex flex-wrap justify-content-center">
									<div class="col-lg-12">
										<h3>{% trans "Installation location" %}</h3>
									</div>
									<div class="col-lg-8 col-xs-12">
										<fieldset class="content-group">
											<div class="row d-flex flex-wrap">
												<div class="form-group col-lg-6 col-xs-12">
													<label class="control-label">{% trans "Hall name" %}</label>
													<div class="">
														<select class="select-hall" name="hall_id">
															<option value="" selected>{% trans "Search by name, frigana, tel or fax" %}</option>
														</select>
													</div>
												</div>
												<div class="form-group col-lg-6 col-xs-12">
													<label class="control-label">{% trans "Address" %}</label>
													<div class="">
														<input type="text" id="hall_address" class="form-control" disabled>
													</div>
												</div>
											</div>
											<div class="row d-flex">
												<div class="form-group col-lg-4 col-xs-12">
													<label class="control-label">{% trans "TEL" %}</label>
													<div class="">
														<input id="hall_tel" type="text" class="form-control" disabled></input>
													</div>
												</div>
											</div>
											<div class="row">
												<div class="form-group col-lg-12">
													<span class="form-control h-70">{% trans "The buyer (hereinafter referred to as A) and the seller (hereinafter referred to as B) have entered into a sales contract including the transaction contract stated on the back of the following products (hereinafter referred to as properties)." %}</span>
												</div>
											</div>
										</fieldset>
									</div>
								</div>

								<div class="row">
									<div class="d-flex flex-wrap mt-5-s">
										<div class="col-6 col-sm-12 px-0">
											<div class="form-group has-feedback d-flex">
												<label class="control-label col-2 mt-auto">{% trans "Product" %}</label>
												<div class="col-lg-8">
													<select class="select-product">
														<option value="" selected>{% trans "Search by model name" %}...</option>
													</select>
												</div>
												<button type="button" name="add_product_btn" class="btn btn-primary">{% trans "Add" %}</button>
											</div>
										</div>
									</div>
									<div class="col-12 pb-5">
										<table class="table table-formset table-product border-bottom">
											{{ productformset.management_form }}
											<thead>
												<tr>
													<th>{% trans "Model name" %}</th>
													<th>{% trans "Product type" %}</th>
													<th>{% trans "Quantity" %}</th>
													<th>{% trans "Price" %}</th>
													<th>{% trans "Amount" %}</th>
												</tr>
											</thead>
											<tbody>
												{% for form in productformset.forms %}
												<tr class="formset_row-{{ productformset.prefix }} w-100">
													{% for field in form.visible_fields %}
													{% if forloop.first %}
													<td>
														<div class="form-group mb-0">
															<div class="px-0">
																{% for hidden in form.hidden_fields %}
																	{{ hidden }}
																{% endfor %}
																<input type="text" 
																	id="id_{{ productformset.prefix }}-{{ forloop.parentloop.counter0 }}-name"
																	class="form-control" disabled="">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-10 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													{% elif forloop.counter == 2 %}
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													{% elif forloop.last %}
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ productformset.prefix }}-{{ forloop.parentloop.counter0 }}-amount"
																	value="0">
															</div>
														</div>
													</td>
													{% endif %}
													{% endfor %}
												</tr>
												{% empty %}
												<tr class="odd">
													<td class="text-center" colspan="5" valign="top">{% trans "No product has been added." %}</td>
												</tr>
												{% endfor %}

												<tr id="{{ productformset.prefix }}-formset-row" style="display: none;">
													<td>
														<div class="form-group mb-0">
															<div class="px-0">
																<input type="hidden"
																	name="{{ productformset.prefix }}-xx-id"
																	id="id_{{ productformset.prefix }}-xx-id"
																	autocomplete="off">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ productformset.prefix }}-xx-name">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-10 px-0">
																<select name="{{ productformset.prefix }}-xx-type"
																class="new-selectbox"
																id="id_{{ productformset.prefix }}-xx-type">
																	<option value="M">{% trans "Main body" %}</option>
																	<option value="F">{% trans "Frame" %}</option>
																	<option value="C">{% trans "Cell" %}</option>
																	<option value="N">{% trans "Nail sheet" %}</option>
																</select>
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="number"
																	name="{{ productformset.prefix }}-xx-quantity"
																	class="form-control"
																	id="id_{{ productformset.prefix }}-xx-quantity"
																	value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="number"
																	name="{{ productformset.prefix }}-xx-price"
																	class="form-control"
																	id="id_{{ productformset.prefix }}-xx-price"
																	value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ productformset.prefix }}-xx-amount"
																	value="0">
															</div>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
	
								<div class="row">
									<div class="d-flex flex-wrap mt-5-s">
										<div class="col-6 col-sm-12 px-0">
											<div class="form-group has-feedback d-flex">
												<label class="control-label col-2 mt-auto">{% trans "Other" %}</label>
												<div class="col-lg-8">
													<select name="select-document" class="selectbox select-document">
														<option value="">{% trans 'Select document' %}...</option>
														{% for document in documents %}
														<option value="{{ document.id }}">{{ document.name }}</option>
														{% endfor %}
													</select>
												</div>
												<button type="button" name="add_document_btn" class="btn btn-primary">{% trans "Add" %}</button>
											</div>
										</div>
									</div>
									<div class="col-12 pb-5">
										<table class="table table-formset table-document border-bottom">
											{{ documentformset.management_form }}
											<thead>
												<tr>
													<th>{% trans "Document" %}</th>
													<th>{% trans "Quantity" %}</th>
													<th>{% trans "Price" %}</th>
													<th>{% trans "Amount" %}</th>
												</tr>
											</thead>
											<tbody>
												{% for form in documentformset.forms %}
												<tr class="formset_row-{{ documentformset.prefix }} w-100">
													{% for field in form.visible_fields %}
													{% if forloop.first %}
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																{% for hidden in form.hidden_fields %}
																	{{ hidden }}
																{% endfor %}
																<input type="text"
																	id="id_{{ documentformset.prefix }}-{{ forloop.parentloop.counter0 }}-name"
																	class="form-control" disabled="">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													{% elif forloop.last %}
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text"
																	class="form-control"
																	id="id_{{ documentformset.prefix }}-{{ forloop.parentloop.counter0 }}-amount"
																	value="70000">
															</div>
														</div>
													</td>
													{% endif %}
													{% endfor %}
												</tr>
												{% empty %}
												<tr class="odd">
													<td class="text-center" colspan="5" valign="top">{% trans "No document has been added." %}</td>
												</tr>
												{% endfor %}

												<tr id="{{ documentformset.prefix }}-formset-row" style="display: none;">
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="hidden"
																	name="{{ documentformset.prefix }}-xx-id"
																	id="id_{{ documentformset.prefix }}-xx-id"
																	autocomplete="off">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ documentformset.prefix }}-xx-name">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																<input type="number"
																	name="{{ documentformset.prefix }}-xx-quantity"
																	class="form-control"
																	id="id_{{ documentformset.prefix }}-xx-quantity"
																	value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																<input type="number"
																	name="{{ documentformset.prefix }}-xx-price"
																	class="form-control"
																	id="id_{{ documentformset.prefix }}-xx-price"
																	value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ documentformset.prefix }}-xx-amount"
																	value="0">
															</div>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
	
								<div class="row">
									<div class="d-flex flex-wrap mt-5-s">
										<div class="col-6 col-sm-12 px-0">
											<div class="form-group has-feedback d-flex">
												<label class="control-label col-2 mt-auto">{% trans "Document fee" %}</label>
												<div class="col-lg-8">
													<select name="select-document-fee" class="selectbox select-document-fee">
														<option value="">{% trans 'Select document fee' %}...</option>
														{% for documentfee in documentfees %}
														<option value="{{ documentfee.id }}">{{ documentfee.name }}</option>
														{% endfor %}
													</select>
												</div>
												<button type="button" name="add_document_fee_btn" class="btn btn-primary">{% trans "Add" %}</button>
											</div>
										</div>
									</div>
									<div class="col-12 pb-80-px">
										<table class="table table-formset table-document-fee border-bottom">
											{{ documentfeeformset.management_form }}
											<thead>
												<tr>
													<th></th>
													<th>{% trans "Product type" %}</th>
													<th>{% trans "Number of models" %}</th>
													<th>{% trans "Number of units" %}</th>
													<th>{% trans "Amount" %}</th>
												</tr>
											</thead>
											<tbody>
												{% for form in documentfeeformset.forms %}
												<tr class="formset_row-{{ documentfeeformset.prefix }} w-100">
													{% for field in form.visible_fields %}
													{% if forloop.first %}
													<td>{% trans "Document fee" %}</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																{% for hidden in form.hidden_fields %}
																	{{ hidden }}
																{% endfor %}
																<input type="text"
																	id="id_{{ documentfeeformset.prefix }}-{{ forloop.parentloop.counter0 }}-name"
																	class="form-control" disabled="">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													{% elif forloop.last %}
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text"
																	class="form-control"
																	id="id_{{ documentfeeformset.prefix }}-{{ forloop.parentloop.counter0 }}-amount"
																	value="70000" disabled>
															</div>
														</div>
													</td>
													{% endif %}
													{% endfor %}
												</tr>
												{% empty %}
												<tr class="odd">
													<td class="text-center" colspan="5" valign="top">{% trans "No document fee has been added." %}</td>
												</tr>
												{% endfor %}

												<tr id="{{ documentfeeformset.prefix }}-formset-row" style="display: none;">
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="hidden"
																	name="{{ documentfeeformset.prefix }}-xx-id"
																	id="id_{{ documentfeeformset.prefix }}-xx-id"
																	autocomplete="off">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ documentfeeformset.prefix }}-xx-name">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																<input type="number"
																	name="{{ documentfeeformset.prefix }}-xx-number_of_models"
																	class="form-control"
																	id="id_{{ documentfeeformset.prefix }}-xx-number_of_models"
																	value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																<input type="number"
																	name="{{ documentfeeformset.prefix }}-xx-number_of_units"
																	class="form-control"
																	id="id_{{ documentfeeformset.prefix }}-xx-number_of_units"
																	value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ documentfeeformset.prefix }}-xx-amount"
																	value="0">
															</div>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
	
								<div class="row flex-wrap d-flex justify-content-between">
									<div class="col-lg-8">
										<div class="input-group h-180-px">
											<span class="input-group-btn">
												<button class="btn btn-default h-197-px">{% trans "Remarks" %}</button>
											</span>
											<textarea type="text" name="remarks" class="form-control h-197-px"></textarea>
										</div>
									</div>
									<div class="col-lg-4 col-xs-12">
										<table class="table table-bordered">
											<tbody>
												<tr>
													<td>{% trans "Subtotal" %}</td>
													<td>85,000</td>
												</tr>
												<tr>
													<td>{% trans "Consumption tax" %} (10%)</td>
													<td>8,500</td>
												</tr>
												<tr>
													<td>
														<div class="checkbox my-0">
															<label>
																<input type="checkbox" class="styled">
																{% trans "Insurance fee" %} ({% trans "No tax" %})
															</label>
														</div>
													</td>
													<td><input type="text" class="form-control" id="insurance_fee" name="insurance_fee" value="0"></td>
												</tr>
												<tr>
													<td>{% trans "Total amount" %}</td>
													<td>93,600</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
	
								<div class="row d-flex justify-content-end payment-step-label">
									<div class="col-lg-6 d-flex justify-content-end">
										<div class="col-lg-11">
											<p>{% trans "We will charge you as follows." %}</p>
										</div>
									</div>
								</div>
	
								<div class="row flex-wrap">
									<div class="col-lg-6">
										<div class="form-group position-relative">
											<div class="input-group">
												<span class="input-group-addon">{% trans "Shipping date" %}</span>
												<input type="text" name="shipping_date" class="form-control daterange-single">
											</div>
											<div class="form-control-feedback">
												<i class="icon-calendar22"></i>
											</div>
										</div>
										<div class="form-group position-relative">
											<div class="input-group">
												<span class="input-group-addon">{% trans "Opening date" %}</span>
												<input type="text" name="opening_date" class="form-control daterange-single">
											</div>
											<div class="form-control-feedback">
												<i class="icon-calendar22"></i>
											</div>
										</div>
										<div class="form-group">
											<div class="form-group">
												<div class="input-group">
													<span class="input-group-addon">{% trans "Payment method" %}</span>
													<select name="payment_method" class="selectbox">
														<option value="TR">{% trans "Transfer" %}</option>
														<option value="CH">{% trans "Check" %}</option>
														<option value="BL">{% trans "Bill" %}</option>
														<option value="CA">{% trans "Cash" %}</option>
													</select>
												</div>
											</div>
										</div>
									</div>
									<div class="col-lg-6 d-flex justify-content-end">
										<div class="col-lg-11">
											<table class="table">
												<tbody>
													<tr>
														<td rowspan="3" width="25%" class="border-left border-bottom text-center">{% trans "Payment breakdown" %}</td>
														<td class="p-0 border-top-0">
															<table  class="table table-bordered">
																{{ milestoneformset.management_form }}
																<tbody>
																	{% for form in milestoneformset.forms %}
																	{% ordinal forloop.counter as nth %}
																	<tr class="formset_row-{{ milestoneformset.prefix }} w-100">
																		{% for field in form.visible_fields %}
																		{% if forloop.first %}
																		
																		<td width="20%">{% trans nth %}</td>
																		<td>
																			<div class="position-relative">
																				{{ field }}
																				<div class="form-control-feedback">
																					<i class="icon-calendar22"></i>
																				</div>
																			</div>
																		</td>
																		{% elif forloop.last %}
																		<td>
																			{{ field }}
																		</td>
																		{% endif %}
																		{% endfor %}
																	</tr>
																	{% endfor %}
																</tbody>
															</table>
														</td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
								</div>
	
								<div class="row mt-5-s d-flex flex-wrap">
									<div class="col-lg-12">
										<p>
											※{% trans "Please bear the transfer fee at your expense." %}
										</p>
									</div>
									
									<div class="col-lg-6">
										<div class="input-group">
											<span class="input-group-btn">
												<button class="btn btn-default">{% trans "Transfer account" %}</button>
											</span>
											<input type="text" class="form-control" name="transfer_account" value="" placeholder="りそな銀行　船場支店（101）　普通　0530713　バッジオカブシキガイシャ">
										</div>
									</div>
	
									<div class="col-lg-3 col-xs-6 d-flex row">
										<div class="w-100 d-flex align-items-center">
											<label class="control-label col-5 mt-auto text-center">{% trans "Person in charge" %}</label>
											<div class="col-7">
												<input type="text" class="form-control" name="person_in_charge" value="">
											</div>
										</div>
									</div>
									<div class="col-lg-3 col-xs-6 d-flex row">
										<div class="w-100 d-flex align-items-center">
											<label class="control-label col-5 mt-auto text-center">{% trans "Confirmor" %}</label>
											<div class="col-7">
												<input type="text" class="form-control" name="confirmor" value="">
											</div>
										</div>
									</div>
								</div>
	
								<div class="row print-btn-group">
									<div class="col-md-12">
										<div class="mb-4 text-center">
											<button type="button" class="btn btn-primary mr-4"><i class="fa fa-print position-left"></i> {% trans "Create contract" %}</button>
											<button type="button" class="btn btn-primary"><i class="fa fa-print position-left"></i> {% trans "Create invoice" %}</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</form>
					<!-- /traffic sources -->
				</div>
			</div>

			{% include "layout/modal.html" %}

			<script>
				$(document).ready(function () {
					
					$.ajax({
						type: 'POST',
						url: '/' + lang + '/contract/manager/',
						data: {
							'contract': 'HallSalesContract'
						},
						beforeSend: function(request) {
							request.setRequestHeader('X-CSRFToken', csrftoken);
						},
						success: function (result) {
							var people = [];
							var data = result.people;
							var i = 0;
							for (var i=0; i<data.length; i++) {
								people.push(data[i].person_in_charge);
							}
							$('input[name="person_in_charge"]').autocomplete({
								source: people
							});
						}
					});
					
				
				});
			</script>

		</div>
		<!-- /content area -->

	</div>
{% endblock %}
