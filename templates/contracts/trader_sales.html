{% extends 'layout/base.html' %}
{% load i18n %}
{% load static %}
{% block title %} {% trans "Trader sales" %} {% endblock title %}

{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

	<!-- Main content -->
	<div class="content-wrapper">

		<!-- Page header -->
		<div class="page-header">
			<div class="page-header-content">
				<div class="page-title">
					<h4>
						<i class="icon-arrow-left52 position-left"></i>
						<span class="text-semibold">{% trans "Contract" %}</span> - {% trans "Trader sales" %}
					</h4>
				</div>
			</div>

			<div class="breadcrumb-line breadcrumb-line-component">
				<ul class="breadcrumb">
					<li><a><i class="icon-cart2 position-left"></i>{% trans "Contract" %}</a></li>
					<li class="active">{% trans "Trader sales" %}</li>
				</ul>
			</div>
		</div>
		<!-- /page header -->

		<!-- Content area -->
		<div class="content">

			<!-- Main charts -->
			<div class="row">
				<div class="col-lg-12">

					<!-- Traffic sources -->
					<form action="" method="POST" name="trader_sales">

						{% csrf_token %}

						<div class="panel panel-flat px-3">
							<div class="panel-title-wrapper container-fluid pt-5">
								<div class="row d-flex flex-wrap">
									<div class="col-3 text-left d-flex align-items-center">
										<label class="control-label mb-0">No.</label>
										<div class="col-6">
											<input type="text" class="form-control border-none" name="contract_id" value="{{ contract_id }}" readonly>
										</div>
									</div>
									<div class="col-6 d-flex align-items-center justify-content-center">
										<h2 class="panel-title text-center">{% trans "Contract and invoice" %}</h2>
									</div>
									
									<div class="col-3 col-sm-12">
										<div class="d-flex align-items-center justify-content-end">
											<span class="contract-date-label">{% trans "Created date" %}</span>
											<div class="input-group">
												<span class="input-group-addon"><i class="icon-calendar22"></i></span>
												<input type="text" name="created_at" class="form-control daterange-single">
											</div>
										</div>
										<div class="d-flex align-items-center justify-content-end mt-3">
											<span class="contract-date-label">{% trans "Updated date" %}</span>
											<div class="input-group">
												<span class="input-group-addon"><i class="icon-calendar22"></i></span>
												<input type="text" name="updated_at" class="form-control daterange-single">
											</div>
										</div>
									</div>
								</div>
							</div>
	
							<div class="container-fluid">
								<div class="row flex-wrap align-items-end d-flex">
									<div class="col-lg-8 col-xs-12 text-left">
										<div class="row d-flex flex-wrap">
											<div class="col-8 col-sm-12">
												<div class="mb-1 d-flex row">
													<label class="control-label w-18-5 mt-auto">{% trans "Company" %}</label>
													<div class="col-9">
														<select class="select-customer" name="name">
															<option value="" selected>{% trans "Search by customer, frigana, tel or fax" %}</option>
														</select>
														
														<div class="form-control-feedback w-50-px">
															<span>{% trans "CO." %}</span>
														</div>
													</div>
												</div>
												<div class="form-group d-flex row">
													<label class="control-label w-18-5 mt-auto pl-10-px"></label>
													<div class="col-9">
														<div class="has-feedback">
															<input type="text" name="manager" class="form-control" placeholder="">
															<div class="form-control-feedback w-50-px">
																<span>{% trans "Mr." %}</span>
															</div>
														</div>
													</div>
												</div>
											</div>
											<div class="col-4 col-sm-12">
												<div class="form-group d-flex row">
													<label class="control-label col-3 mt-auto text-right">{% trans "Frigana" %}</label>
													<div class="col-9">
														<input type="text" name="frigana" class="form-control" disabled>
													</div>
												</div>
											</div>
										</div>

										<div class="row d-flex flex-wrap">
											<div class="col-6 col-sm-12">
												<div class="form-group d-flex row">
													<label class="control-label col-3 mt-auto">{% trans "Postal code" %}</label>
													<div class="col-7">
														<input type="text" name="postal_code" class="form-control" disabled>
													</div>
												</div>
											</div>
										</div>
	
										<div class="row">
											<div class="col-12 col-sm-12">
												<div class="form-group d-flex row">
													<label class="control-label w-12-5 col-sm-3 mt-auto">{% trans "Address" %}</label>
													<div class="col-6">
														<input type="text" name="address" class="form-control" disabled>
													</div>
												</div>
											</div>
										</div>
	
										<div class="row flex-wrap d-flex">
											<div class="col-6 col-sm-12">
												<div class="form-group d-flex row">
													<label class="control-label col-3 mt-auto">{% trans "TEL" %}</label>
													<div class="col-7">
														<input type="text" name="tel" class="form-control" disabled>
													</div>
												</div>
											</div>										
											<div class="col-5 col-sm-12">
												<div class="form-group d-flex row">
													<label class="control-label col-2 mt-auto text-center">{% trans "FAX" %}</label>
													<div class="col-8">
														<input type="text" name="fax" class="form-control" disabled>
													</div>
												</div>
											</div>
										</div>										
									</div>
									<div class="col-lg-1"></div>
									<div class="col-lg-3 col-xs-12">
										<div>
											<div class="form-group d-flex row">
												<div class="w-100 d-flex align-items-center">
													<label class="control-label col-5 mt-auto">P-SENSOR {% trans "Member ID" %}</label>
													<div class="col-7">
														<input type="text" name="member_id" class="form-control" value="8240-2413-3628" disabled>
													</div>
												</div>
											</div>
											<div class="form-group d-flex row">
												<div class="w-100 d-flex align-items-center">
													<label class="control-label col-5 mt-auto">{% trans "Person in charge" %}</label>
													<div class="col-7">
														<input type="text" name="person_in_charge" class="form-control person_in_charge" value="">
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="row">
									<div class="d-flex flex-wrap mt-5-s">
										<div class="col-6 col-sm-12 px-0">
											<div class="form-group has-feedback d-flex">
												<label class="control-label col-2 mt-auto">{% trans "Product" %}</label>
												<div class="col-lg-8">
													<select class="select-product">
														<option value="" selected>{% trans "Search by model name" %}...</option>
													</select>
												</div>
												<button type="button" name="add_product_btn" class="btn btn-primary">{% trans "Add" %}</button>
											</div>
										</div>
									</div>
									<div class="col-12 pb-5">
										<table class="table table-product border-bottom">
											{{ productformset.management_form }}
											<thead>
												<tr>
													<th>{% trans "Model name" %}</th>
													<th>{% trans "Product type" %}</th>
													<th>{% trans "Quantity" %}</th>
													<th>{% trans "Price" %}</th>
													<th>{% trans "Amount" %}</th>
												</tr>
											</thead>
											<tbody>
												{% for form in productformset.forms %}
												<tr class="formset_row-{{ productformset.prefix }} w-100">
													{% for field in form.visible_fields %}
													{% if forloop.first %}
													<td>
														<div class="form-group mb-0">
															<div class="px-0">
																{% if forloop.first %}
																	{% for hidden in form.hidden_fields %}
																		{{ hidden }}
																	{% endfor %}
																{% endif %}
																<input type="text" 
																	id="id_{{ productformset.prefix }}-{{ forloop.parentloop.counter0 }}-name"
																	class="form-control" disabled="">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-10 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													{% elif forloop.counter == 2 %}
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													{% elif forloop.last %}
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																{{ field }}
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text"
																	class="form-control"
																	disabled=""
																	id="id_{{ productformset.prefix }}-{{ forloop.parentloop.counter0 }}-amount"
																	value="0">
															</div>
														</div>
													</td>
													{% endif %}
													{% endfor %}
												</tr>
												{% empty %}
												<tr class="odd">
													<td class="text-center" colspan="5" valign="top">{% trans "No product has been added." %}</td>
												</tr>
												{% endfor %}

												<tr id="{{ productformset.prefix }}-formset-row" style="display: none;">
													<td>
														<div class="form-group mb-0">
															<div class="px-0">
																<input type="hidden" name="{{ productformset.prefix }}-xx-id" id="id_{{ productformset.prefix }}-xx-id">
																<input type="text" class="form-control" disabled="" id="id_{{ productformset.prefix }}-xx-name">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-10 px-0">
																<select name="{{ productformset.prefix }}-xx-type" class="new-selectbox" id="id_{{ productformset.prefix }}-xx-type">
																	<option value="M">{% trans "Main body" %}</option>
																	<option value="F">{% trans "Frame" %}</option>
																	<option value="C">{% trans "Cell" %}</option>
																	<option value="N">{% trans "Nail sheet" %}</option>
																</select>
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="number" name="{{ productformset.prefix }}-xx-quantity" class="form-control" id="id_{{ productformset.prefix }}-xx-quantity" value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="number" name="{{ productformset.prefix }}-xx-price" class="form-control" id="id_product-xx-price" value="0">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text" class="form-control" disabled="" id="id_{{ productformset.prefix }}-xx-amount" value="0">
															</div>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
								
								<div class="row">
									<div class="d-flex flex-wrap mt-5-s">
										<div class="col-6 col-sm-12 px-0">
											<div class="form-group has-feedback d-flex">
												<label class="control-label col-2 mt-auto">{% trans "Other" %}</label>
												<div class="col-lg-8">
													<select name="select" class="selectbox">
														<option value="">{% trans 'Select document' %}...</option>
														{% for document in documents %}
														<option value="{{ forloop.counter }}">{{ document.name }}</option>
														{% endfor %}
													</select>
												</div>
												<button type="button" name="document_add_btn" class="btn btn-primary">{% trans "Add" %}</button>
											</div>
										</div>
									</div>
									<div class="col-12 pb-80-px">
										<table class="table table-product border-bottom">
											{{ documentformset.management_form }}
											<thead>
												<tr>
													<th>{% trans "Document" %}</th>
													<th>{% trans "Quantity" %}</th>
													<th>{% trans "Price" %}</th>
													<th>{% trans "Amount" %}</th>
												</tr>
											</thead>
											<tbody>
												{% for form in documentformset.forms %}
												<tr class="formset_row-{{ documentformset.prefix }} w-100">
													{% for field in form.visible_fields %}
													<td class="w-30">
														<div class="form-group mb-0">
															{% if forloop.first %}
																<div class="col-lg-7 px-0">
																	{% for hidden in form.hidden_fields %}
																		{{ hidden }}
																	{% endfor %}
																	{{ field }}
																</div>
															{% endif %}

															{% if forloop.last %}
																<div class="col-lg-7 px-0">
																	{{ field }}
																</div>
															{% endif %}
															
															{% if forloop.counter == 2 %}
																<div class="col-lg-6 px-0">
																	{{ field }}
																</div>
															{% endif %}

															{% if forloop.counter == 3 %}
																<div class="col-lg-6 px-0">
																	{{ field }}
																</div>
															{% endif %}
															
														</div>
													</td>
													{% endfor %}
												</tr>
												{% empty %}
												<tr class="odd">
													<td class="text-center" colspan="5" valign="top">{% trans "No document has been added." %}</td>
												</tr>
												{% endfor %}

												<tr id="non-formset-row" style="display: none;">
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text" class="form-control" value="">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																<input type="text" class="form-control" value="1">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-6 px-0">
																<input type="text" class="form-control" value="7000">
															</div>
														</div>
													</td>
													<td>
														<div class="form-group mb-0">
															<div class="col-lg-7 px-0">
																<input type="text" class="form-control" value="70000">
															</div>
														</div>
													</td>
												</tr>
											</tbody>
										</table>

									</div>
								</div>
								
								<div class="row flex-wrap d-flex justify-content-between">
									<div class="col-lg-8 col-xs-12">
										<div class="row">
											<div class="col-lg-6 form-group">
												<div class="position-relative">
													<div class="input-group">
														<span class="input-group-addon">{% trans "Shipping date" %}</span>
														<input type="text" name="shipping_date" class="form-control daterange-single">
													</div>
													<div class="form-control-feedback">
														<i class="icon-calendar22"></i>
													</div>
												</div>
											</div>
											<div class="col-lg-12 col-xs-12">
												<div class="">
													<div class="input-group">
														<span class="input-group-addon">{% trans "Remarks" %}</span>
														<textarea type="text" name="remarks" class="form-control remarks"></textarea>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="col-lg-4 col-xs-12">
										<table class="table table-bordered">
											<tbody>
												<tr>
													<td>{% trans "Subtotal" %}</td>
													<td>85,000</td>
													<input type="hidden" name="subtotal" value="">
												</tr>
												<tr>
													<td>{% trans "Consumption tax" %} (10%)</td>
													<td>8,500</td>
													<input type="hidden" name="consumption_tax" value="">
												</tr>
												<tr>
													<td>
														<div class="checkbox my-0">
															<label>
																<input type="checkbox" class="styled">
																{% trans "Insurance fee" %} ({% trans "No tax" %})
															</label>
														</div>
													</td>
													<td>100</td>
													<input type="hidden" name="insurance_fee" value="">
												</tr>
												<tr>
													<td>{% trans "Total" %}</td>
													<td>93,600</td>
													<input type="hidden" name="total" value="">
												</tr>
											</tbody>
										</table>
									</div>
								</div>
								<div class="row mt-5-s d-flex flex-wrap">
									<div class="col-6">
										<div class="form-group">
											<div class="input-group">
												<span class="input-group-addon">{% trans "Shiping method" %}</span>
												<select name="shipping_method" class="selectbox">
													<option value="D">{% trans "Delivery" %}</option>
													<option value="R">{% trans "Receipt" %}</option>
													<option value="C">{% trans "ID Change" %}</option>
													<option value="B">{% trans "* Blank" %}</option>
												</select>
											</div>
										</div>
										<div class="form-group">
											<div class="input-group">
												<span class="input-group-addon">{% trans "Payment method" %}</span>
												<select name="payment_method" class="selectbox">
													<option value="TR">{% trans "Transfer" %}</option>
													<option value="CH">{% trans "Check" %}</option>
													<option value="BL">{% trans "Bill" %}</option>
													<option value="CA">{% trans "Cash" %}</option>
												</select>
											</div>
										</div>
									</div>
									<div class="col-6">
										<div class="form-group">
											<div class="input-group">
												<span class="input-group-addon">{% trans "Billing amount" %}</span>
												<input type="text" class="form-control" name="total_amount">
											</div>
										</div>
										<div class="position-relative form-group">
											<div class="input-group">
												<span class="input-group-addon">{% trans "Due date" %}</span>
												<input type="text" name="due_date" class="form-control daterange-single">
											</div>
											<div class="form-control-feedback">
												<i class="icon-calendar22"></i>
											</div>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-12 form-group">
										<textarea type="text" class="form-control h-200-px">※ {% trans "The contract will be effective when both seller and buyer sign and seal." %}
※ {% trans "As a general rule, the contract cannot be canceled once signed." %}
※ {% trans "3 days warranty after delivery will be provided just in case of defects or malfunctions in the products." %}
※ {% trans "The seller will keep the ownership of the products until the buyer makes the full payment." %}
※ {% trans "The Ownership of the products shall be transferred to the buyer when product delivery is completed and full payment is made." %}
※ {% trans "In the following cases, the seller may, without any procedure, request the immediate payment of the remaining balance, or cancel the contract and take back the products." %}
	1) {% trans "When the buyer fail to make the payment even once." %}
	2) {% trans "When the products were forfeited or disposed temporarily, or the request for arrangement, reconciliation, damage etc is received." %}
										</textarea>
									</div>
								</div>
								<div class="row d-flex flex-wrap mt-5-s">
									<div class="col-lg-6 col-xs-12">
										<fieldset class="content-group">
											<legend class="text-bold text-center">{% trans "Product sender" %}</legend>
											<div class="form-group">
												<label class="control-label">{% trans "Company" %}</label>
												<div class="">
													<input type="text" name="product_shipping_company" class="form-control">
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "Address" %}</label>
												<div class="">
													<textarea type="text" name="product_shipping_address" class="form-control"></textarea>
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "TEL" %}</label>
												<div class="">
													<input type="text" name="product_shipping_tel" class="form-control"></input>
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "FAX" %}</label>
												<div class="">
													<input type="text" name="product_shipping_fax" class="form-control"></input>
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "Expected arrival date" %}</label>
												<div class="input-group">
													<span class="input-group-addon"><i class="icon-calendar22"></i></span>
													<input type="text" name="product_shipping_arrival_date" class="form-control daterange-single">
												</div>
											</div>
										</fieldset>
										
									</div>
									<div class="col-lg-6 col-xs-12">
										<fieldset class="content-group">
											<legend class="text-bold text-center">{% trans "Document sender" %}</legend>
											<div class="form-group">
												<label class="control-label">{% trans "Company" %}</label>
												<div class="">
													<input type="text" name="document_shipping_company" class="form-control">
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "Address" %}</label>
												<div class="">
													<textarea type="text" name="document_shipping_address" class="form-control"></textarea>
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "TEL" %}</label>
												<div class="">
													<input type="text" name="document_shipping_tel" class="form-control"></input>
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "FAX" %}</label>
												<div class="">
													<input type="text" name="document_shipping_fax" class="form-control"></input>
												</div>
											</div>
											<div class="form-group">
												<label class="control-label">{% trans "Expected arrival date" %}</label>
												<div class="input-group">
													<span class="input-group-addon"><i class="icon-calendar22"></i></span>
													<input type="text" name="document_shipping_arrival_date" class="form-control daterange-single">
												</div>
											</div>
										</fieldset>
									</div>
								</div>
								<div class="row mt-5-s">
									<div class="col-lg-6 col-xs-12">
										<h6 class="text-center">{% trans "Buyer seal" %}</h6>
										<div class="seal-wrapper">
											<p>〒<span class="buyer-postal-code ml-4"></span><span class="buyer-address ml-4"></span></p>
											<h4 class="buyer-company"></h4>
											<p><span>代表取締役</span><span class="buyer ml-4"></span></p>
											<p class="mb-0 d-flex">
												<span class="w-min-150-px">TEL : <span class="buyer-tel"></span></span>
												<span class="ml-4 w-min-150-px">FAX : <span class="buyer-fax"></span></span>
											</p>
											<div class="seal">
												印
											</div>
										</div>
									</div>
									<div class="col-lg-6 col-xs-12">
										<h6 class="text-center">{% trans "Seller seal" %}</h6>
										<div class="seal-wrapper">
											<p>〒<span class="seller-postal-code ml-4">537―0021</span><span class="seller-address ml-4">大阪府大阪市東成区東中本2丁目4―15</span></p>
											<h4 class="seller-company">バッジオ株式会社</h4>
											<p><span>代表取締役</span><span class="seller ml-4">金 昇志</span></p>
											<p class="mb-0 d-flex">
												<span class="w-min-150-px">TEL : <span class="seller-tel">06-6753-8078</span></span>
												<span class="ml-4 w-min-150-px">FAX : <span class="seller-fax">06-6753-8078</span></span>
											</p>
											<div class="seal">
												印
											</div>
										</div>
									</div>
								</div>
								<div class="row mt-5-s">
									<div class="col-lg-6 col-xs-12">
										<p>※ {% trans "Please be noted that the transfer fee will be at your company expense." %}</p>
										<p>
											<span>{% trans "Transfer account" %}:</span>
											<span>りそな銀行　船場支店（101）　普通　0530713　バッジオカブシキガイシャ</span>
										</p>
										<p>
											<span>{% trans "Please check the contents. After seal, kindly revert back to us." %}</span>
											<span class="ml-4">{% trans "FAX" %} 06-6753-8079</span>
										</p>
										<p>※ {% trans "If you need the original invoice, please make sure to tick the checkbox." %} 【{% trans "Necessary" %}・{% trans "Unnecessary" %}】</p>
									</div>
									<div class="col-lg-6 col-xs-12">
										<div class="input-group">
											<span class="input-group-addon">{% trans "Remarks" %}</span>
											<textarea type="text" class="form-control remarks"></textarea>
										</div>
									</div>
								</div>
								<div class="row print-btn-group">
									<div class="col-md-12">
										<div class="mb-4 text-center">
											<button type="submit" class="btn btn-primary mr-4"><i class="fa fa-print position-left"></i> {% trans "Create contract" %}</button>
											<button type="button" class="btn btn-primary"><i class="fa fa-print position-left"></i> {% trans "Create invoice" %}</button>
										</div>
									</div>
								</div>
							</div>
	
						</div>
					</form>
					<!-- /traffic sources -->

				</div>
			</div>

			{% include "layout/modal.html" %}

			<script>
				$(document).ready(function () {
					$('input[name="person_in_charge"]').change(function (e) {
						$('span.buyer').text($(this).val());
					});
				});
			</script>

		</div>
		<!-- /content area -->

	</div>
	<!-- /main content -->

{% endblock %}
